<script src="https://prod-cdn.superblocks.com/packages/@superblocksteam/embed@latest/embed.bundle.js"></script>
<script>
  // Embed the Superblocks app
  const sbApp = Superblocks.createSuperblocksEmbed({
    src: "https://app.superblocks.com/embed/applications/a6bc8e63-fe6d-4303-8467-3add244e916f",
  });

  // Wait for the DOM to be ready before appending
  window.onload = function () {
    console.log("Parent app is ready.");
    document.body.appendChild(sbApp); // Ensure the body is ready
  };

  // Listen for messages from the embedded app
  window.addEventListener("message", (event) => {
    console.log("Received message event:", event); // Debug: Log the full event
    console.log("Received message data:", event.data); // Debug: Log just the data

    // Validate the message origin
    if (event.origin !== "https://app.superblocks.com") {
      console.warn("Untrusted origin:", event.origin);
      return;
    }

    // Handle "taskAdded" action
    if (event.data && event.data.action === "taskAdded") {
      console.log("Task added message:", event.data.message);

      // Create and display the message in the parent app
      const messageElement = document.createElement("p");
      messageElement.textContent = event.data.message || "No message content";
      document.body.appendChild(messageElement); // Add it to the DOM
    } else {
      console.warn("Unexpected message format or action:", event.data);
    }
  });
</script>
