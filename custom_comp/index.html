<script src="https://prod-cdn.superblocks.com/packages/@superblocksteam/embed@latest/embed.bundle.js"></script>
<script>
  // Embed the Superblocks app
  const sbApp = Superblocks.createSuperblocksEmbed({
    src: "https://app.superblocks.com/embed/applications/a6bc8e63-fe6d-4303-8467-3add244e916f",
  });

  // Wait for the DOM to be ready before appending
  window.onload = function () {
    document.body.appendChild(sbApp); // Ensure the body is ready
  };

  // Listen for messages from the embedded app
  window.addEventListener("message", (event) => {
    console.log("Received message event:", event); // Debug: Log the full event
    console.log("event.data:", event.data); // Debug: Log the data specifically

    // Ensure the message is coming from the correct Superblocks app
    if (event.origin !== "https://app.superblocks.com") {
      console.log("Untrusted origin:", event.origin);
      return;
    }

    // Check if the action is "taskAdded"
    if (event.data && event.data.action === "taskAdded") {
      const message = event.data.message || event.data.data?.message; // Handle potential structures
      console.log("Task added message:", message);

      // Display the message in the parent app
      const messageElement = document.createElement("p");
      messageElement.textContent = message; // Should display "hello"
      document.body.appendChild(messageElement); // Add it to the DOM
    }
  });
</script>
